<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ReportCare | Secure Medical Verification</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>
<body>

<nav class="navbar">
    <div class="left">
        <span class="menu" onclick="toggleMenu()" style="margin-right: 15px; cursor:pointer;">â˜°</span>
        <span class="logo">
            <span class="shield">ğŸ›¡ï¸</span> Report<span style="color:#27AE60;">Care</span>
        </span>
        <a href="/verifyreport" style="margin-left: 20px; text-decoration: none; color: #333; font-size: 14px; font-weight: 500;">
        <i class="fas fa-search-location"></i> Report Checking
    </a>
    </div>
    
    <div class="right" style="display: flex; align-items: center; gap: 15px;">
        <div class="lang-buttons">
            <button>Take</button>
            <button>Care</button>
        </div>

        {% if current_user %}
            <div class="user-profile-nav" style="display: flex; align-items: center; gap: 12px;">
                <a href="/profile" style="display: flex; align-items: center; text-decoration: none; gap: 8px;">
                    <span style="color: black; font-size: 0.9rem; font-weight: 500;">{{ current_user.name }}</span>
                    <img src="{{ url_for('static', filename='uploads/profile_pictures/' + (current_user.profile_pic if current_user.profile_pic else 'default_user.png')) }}" 
                         class="nav-profile-img" alt="Profile" 
                         style="width: 35px; height: 35px; border-radius: 50%; object-fit: cover; border: 2px solid #27AE60;">
                </a>
                <a href="/logout" class="btn logout-btn" style="background-color: #e74c3c; padding: 6px 12px; font-size: 13px;">Logout</a>
            </div>
        {% else %}
            <a href="/login" class="btn">Login</a>
            <a href="/register" class="btn">Register</a>
        {% endif %}
    </div>
</nav>

<div id="sideMenu" class="side-menu">
    <div class="side-menu-header">
        <span class="close-btn" onclick="toggleMenu()">&times;</span>
        
        {% if current_user %}
        <a href="/profile" class="sidebar-profile-link" style="text-decoration: none;">
            <div class="sidebar-profile">
                <img src="{{ url_for('static', filename='uploads/profile_pictures/' + (current_user.profile_pic if current_user.profile_pic else 'default_user.png')) }}" alt="Profile">
                <div class="profile-info">
                    <h4>{{ current_user.name }}</h4>
                    <p>{{ current_user.role }}</p>
                </div>
            </div>
        </a>
        {% endif %}
    </div>
    
    <div class="sidebar-content">
        {% if current_user %}
            <div style="padding: 10px; border-bottom: 1px solid #444;">
                <p style="color: #27AE60; font-size: 11px; font-weight: bold; margin-bottom: 5px;">SMART SEARCH</p>
                <form action="/global-search" method="GET" style="display: flex; background: #333; border-radius: 5px; overflow: hidden;">
                    <input type="text" name="q" placeholder="Search Names..." style="flex: 1; border: none; padding: 8px; background: transparent; color: white; font-size: 13px; outline: none;">
                    <button type="submit" style="background: transparent; border: none; color: #27AE60; padding: 8px; cursor: pointer;"><i class="fas fa-search"></i></button>
                </form>
            </div>
        {% endif %}

        <a href="/">ğŸ  Home</a>
        <a href="/about">â„¹ï¸ About Us</a>
        <a href="/verify">ğŸ›¡ï¸ Verify Report</a>
        <a href="/verifyreport" style="background: rgba(39, 174, 96, 0.1); border-left: 4px solid #27AE60;">
        <i class="fas fa-shield-alt"></i> ğŸ›¡ï¸Report Checking
    </a>
        <a href="/how-it-works">âš™ï¸ How It Works</a>

        <hr style="border: 0.5px solid #444; margin: 10px 0;">

        {% if current_user %}
            {% if current_user.role == 'Lab' %}
                <div class="role-header">Lab PANEL</div>
                <a href="/create-patient">â• Create Patient</a>
                <a href="/doctor-view-patients">ğŸ‘¥ View Patients</a>
                <a href="/predict">ğŸ§¬ Run Prediction</a>
                 <a href="/my-generated-reports">ğŸ“„ Generated Reports</a>
                

            {% elif current_user.role == 'User' %}
                <div class="role-header">PATIENT PANEL</div>
                <a href="/predict">ğŸ§¬ Run Prediction</a> <a href="/my-generated-reports">ğŸ“„ Generated Reports</a>
                <a href="/my-reports">ğŸ“‘ My Reports</a>
                <a href="/search-history">ğŸ“œ Analysis History</a>
            {% endif %}
            
            <div class="sidebar-footer">
                <a href="/logout" class="logout-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </div>
        {% endif %} </div>
</div>

{% block content %}{% endblock %}

<script>
function toggleMenu() {
    const menu = document.getElementById("sideMenu");
    menu.classList.toggle("active");
}

window.onload = function() {
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    const success = urlParams.get('success');
    if (error) showToast(error, "#e74c3c");
    if (success) showToast(success, "#27AE60");
};

function showToast(msg, color) {
    Toastify({
        text: msg,
        duration: 4000,
        gravity: "top",
        position: "right",
        style: { background: color, borderRadius: "8px" }
    }).showToast();
}
</script>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>